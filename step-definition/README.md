# Про паттерн Step definition

**Step Definition** - это способ организации автотестов, при котором все действия пользователя или шаги API-запросов выносятся в отдельный
класс (или классы). Эти классы называются "Steps" (шаги), и они описывают, что именно делает пользователь или тест — но не как.
Простыми словами: тест становится похож на пошаговую инструкцию, а детали реализации этих шагов спрятаны отдельно. Это делает тесты более 
читаемыми и легкими в поддержке.

## Когда использовать?
В UI-тестах: действия пользователя — это шаги, которые можно вынести отдельно<br>
API-тесты: вызовы API и проверки — это шаги

# Задача

Необходимо написать автотесты на REST API интернет магазина животных. Конкретно на метод POST /addPet из [документации по ссылке](https://petstore.swagger.io/#/pet/addPet).
При тестировании необходимо убедиться, что метод POST /addPet действительно создал питомца. Для этого необходимо вызвать метод [GET 
/getPetById](https://petstore.swagger.io/#/pet/getPetById) и сверить имя созданного питомца. 


# Решение без применения паттерна

[PostStoreOrderTests.java](src/test/java/PostStoreOrderTests.java)

## ❌ Минусы:
- Логика запроса и проверки размазана по тесту
- Повторение кода (например, настройки запроса)
- Тест сложно читать. Слишком много технических деталей. Вместо того чтобы описывать, что происходит в тесте (например, «создаём питомца», 
  «проверяем, что он существует»), он показывает, как именно это делается: какие URL вызываются, какие поля в JSON, какие селекторы, какие методы RestAssured и т.д.
<br>
Мы хотим, чтобы тесты рассказывал бизнес-смысл:
- Создать питомца.
- Проверить его данные.
<br> 
А не технические детали:
- Оправить POST-запрос
- Спарсить тело ответа ....

# Как реализовать паттерн

Вынести шаги по работе с питомцами в отдельный класс [PetSteps.java](src/main/java/ru/nmt/steps/PetSteps.java)

# Решение с применением паттерна

[PostPetWithStepDefinitionTests.java](src/test/java/PostPetWithStepDefinitionTests.java)

## ✅ Плюсы:

- Тест читается как сценарий: "создать → получить → проверить"
- Шаги можно переиспользовать в других тестах
- При изменениях в API — правим только Step-класс
- Легко добавлять логирование, отчеты, обработку ошибок

## ❌ Минусы:

В некотором смысле нарушается принцип Single Responsibility Principle (SRP). В классе PetSteps.java появляются методы связанные и с 
Arrange и с Act и с Assert.<br>

### Что делать, чтобы не нарушать принцип SPR?
Начинаем выноси части из класса PetSteps.java в отдельные классы:
- Если шаги становятся сложными или повторяются,
- Если класс разрастается и в нем становится сложно ориентироваться.

<br>
Что можно выделить в отдельные классы:
- ApiActions — только  запросы (Act)
- ApiAssertions — только проверки (Assert)
- ApiDataFactory — только генерация данных (Arrange)
